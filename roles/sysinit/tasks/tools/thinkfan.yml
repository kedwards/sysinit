---
- name: Thinkfan - Configure modprobe
  ansible.builtin.lineinfile:
    path: /etc/modprobe.d/thinkfan.conf
    state: present
    line: 'options thinkpad_acpi fan_control=1'
    mode: "0644"
    create: true

- name: Thinkfan - Configure default thinkfan
  ansible.builtin.lineinfile:
    path: /etc/default/thinkfan
    state: present
    line: 'START=yes'
    mode: "0644"
    create: true

- name: Thinkfan - Configure thinkfan
  ansible.builtin.copy:
    src: "{{ role_path }}/files/thinkfan.conf"
    dest: /etc/thinkfan.conf
    mode: "0644"

- name: Thinkfan - Start service and enable
  ansible.builtin.service:
    name: thinkfan
    state: started
    enabled: true
